# Важные замечания по использованию аналитики блоков

1\. Счетчик Топ-100 поддерживает до восьми уровней вложенности блоков. Название каждого сегмента пути имеет ограничение в 255 символов. Всего блоков в одном просмотре страницы (на одной странице) может быть не более 500.

2\. Показы блоков засчитываются только тогда, когда блок непосредственно отобразился в рамках окна пользователя. Просмотренными считаются блоки отобразившиеся хотя бы\
на 10%.

3\. Показы и клики суммируются на каждом уровне:

* Количество показов для блока, имеющего дочерние элементы, рассчитывается как максимум из числа показов его дочерних элементов + собственные показы блока.&#x20;
* Количество кликов для блока, имеющего дочерние элементы рассчитывается как сумма кликов на дочерние элементы + собственные клики на блок.

Значение CTR рассчитывается для каждого уровня отдельно и выражается как отношение кликов к показам блоков.

Чтобы собственные показы и клики родительского блока не суммировались с показами и кликами на дочерние блоки, рекомендуется размечать такие структуры линейно, без привязки к DOM-разметке. Подробнее см. в [правилах использования аналитики блоков, п.3](pravila-ispolzovaniya-analitiki-blokov.md).

4\. При разметке, где у родителя отличается название data-атрибута от названия data-атрибута у ребенка, клики по ребенку будут также вызывать дополнительные клики по родителю.

**Пример:**

В разметке одного из контейнеров есть отличающийся data-атрибут `data-new-attr`.&#x20;

```
<div data-just-test-attr="YOUR_LOGICAL_CONTAINER">
    <a href='link' data-just-test-attr="YOUR_LOGICAL_NAME_1">Linktext</a>
    <div data-new-attr="YOUR_LOGICAL_CONTAINER_2">
        <a href='link' data-just-test-attr="YOUR_LOGICAL_NAME_2">Linktext</a>
    </div>
</div>
```

При клике на ссылку __ `YOUR_LOGICAL_NAME_2` получим два отправленных события клика: \
`just-test-attr::YOUR_LOGICAL_CONTAINER::YOUR_LOGICAL_NAME_2` \
и\
&#x20;`new-attr::YOUR_LOGICAL_CONTAINER_2`

Такое поведение обусловлено поднимающимся событием клика вверх по дереву элементов. Если нет необходимости получать клики по ненужным атрибутам, то рекомендуется убирать лишние атрибуты из кода счетчика, а также убирать лишнюю разметку на странице.

5\. При перерендере (перерисовке) размеченных аналитикой блоков элементов, показы этих блоков будут повторно отправляться. Фактически, при перерисовке элемент считается новым, поэтому по нему будет повторно отправлен показ. Рекомендуется избегать ненужных перерисовок отслеживаемых элементов.&#x20;
