# Топ сайтов темы

Позволяет получить топ сайтов в выбранной теме каталога Топ-100.

**URL:** `GET /api/partner/v2.0/rating/feed?categories=<int:theme_id>`

## Параметры запроса <a href="9" id="9"></a>

| **Поле**   | **Тип**       | **Описание**                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ---------- | ------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| date       | ISO Date      | Дата за которую нужно построить топ сайтов.                                                                                                                                                                                                                                                                                                                                                                                        |
| categories | CSV\[Integer] | Список категорий по которым нужно построить топ сайтов (будет осуществляться пересечение по всем указанным категориям).                                                                                                                                                                                                                                                                                                            |
| regions    | CSV\[Integer] | Список регионов по которым нужно построить топ сайтов.                                                                                                                                                                                                                                                                                                                                                                             |
| sort       | String        | Параметр сортировки. Одно из возможных значений: 'visitors', 'page_views', 'popularity'.                                                                                                                                                                                                                                                                                                                                           |
| limit      | Integer       | Параметр для пагинации результатов запроса. Задает максимальное количество элементов в ответе на запрос.                                                                                                                                                                                                                                                                                                                           |
| offset     | Integer       | Параметр для пагинации результатов запроса. Задает смещение в выборке данных относительно предыдущего запроса. Например, хотим получить выборку из 50-ти элементов с разбивкой по 10. Тогда первый раз вызываем запрос с limit=10 и offset=0 и получаем в ответе первые 10 элементов. Затем еще раз вызываем данный запрос с limit=10 и offset=10 и получаем в ответе вторые 10 элементов. И т.д. – всего будет 5 вызовов запроса. |

**Пример запроса**

```
GET /api/partner/v2.0/rating/feed?limit=2&categories=1000 HTTP/1.1
Accept: */*
Accept-Encoding: gzip, deflate
Authorization: key qwertyuiop1234567890
Connection: keep-alive
Host: localhost:8080
User-Agent: HTTPie/0.9.9
```

## Параметры ответа <a href="10" id="10"></a>

| **Поле** | **Тип**        | **Описание**                                                                                                                                                                            |
| -------- | -------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| result   | List\[Website] | Список сайтов, входящих в топ. Содержит массив структур \<Website> (с вложенными полями, характеризующими каждый из отобранных сайтов). Описание структуры объекта \<Website> см. ниже. |
| meta     |                | Структура с вложенным полем total (его писание см. ниже в таблице).                                                                                                                     |
| total    | Int            |                                                                                                                                                                                         |

**Структура объекта \<Website>**

| **Поле**         | **Тип** | **Описание**                      |
| ---------------- | ------- | --------------------------------- |
| id               | Int     | Идентификатор счетчика.           |
| page_views       | Int     | Количество показов страниц сайта. |
| page_views_delta | Int     |                                   |
| popularity       | Float   | Индекс популярности.              |
| popularity_delta | Float   |                                   |
| position         | Int     | Позиция сайта в топе.             |
| title            | String  | Название счетчика (сайта).        |
| url              | String  | URL сайта.                        |
| visitors         | Int     | Количество посетителей.           |
| visitors_delta   | Int     |                                   |

**Пример ответа**

```
HTTP/1.0 200 OK
Connection: close
Content-Type: application/json
Date: Thu, 07 Sep 2017 14:28:44 GMT
Server: Werkzeug/0.12.2 Python/3.6.1
{
    "result": [
        {
            "id": 1518885,
            "page_views": 4150616,
            "page_views_delta": 1760803,
            "popularity": 96878.9,
            "popularity_delta": 3813.9,
            "position": 1,
            "title": "Exist.ru - продажа автозапчастей для иномарок",
            "url": "http://www.exist.ru",
            "visitors": 268274,
            "visitors_delta": 97813
        },
        {
            "id": 2489854,
            "page_views": 379797,
            "page_views_delta": 10718,
            "popularity": 88741.8,
            "popularity_delta": 95.7,
            "position": 2,
            "title": "\"АвтоВзгляд\"",
            "url": "http://www.avtovzglyad.ru/",
            "visitors": 226580,
            "visitors_delta": 15666
        }
    ],
    "meta": {
        "total": 9638
    }
}
```
